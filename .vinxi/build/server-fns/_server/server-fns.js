import{lazy as er,createComponent as it,createContext as Ie,createUniqueId as tr,useContext as nt,createRenderEffect as at,onCleanup as ke,sharedConfig as Fe,getOwner as ot,runWithOwner as lt,createMemo as x,createSignal as D,untrack as De,on as ct,startTransition as rr,resetErrorBoundaries as _e,children as sr,createRoot as ir,Show as ut,Suspense as nr}from"solid-js";import{ssrElement as le,escape as ve,mergeProps as ar,ssr as dt,isServer as $,getRequestEvent as B,createComponent as w,spread as Me,useAssets as or,delegateEvents as lr,renderToString as cr}from"solid-js/web";import{provideRequestEvent as ht}from"solid-js/web/storage";import{H3Event as ye,setResponseStatus as ur,setHeader as dr,getRequestIP as hr,getResponseStatus as fr,getResponseStatusText as pr,getCookie as mr,setCookie as gr,getRequestURL as vr,getResponseHeaders as yr,getResponseHeader as br,setResponseHeader as wr,appendResponseHeader as Sr,removeResponseHeader as zr,getRequestWebStream as Rr,eventHandler as Ar}from"h3";import{AsyncLocalStorage as Er}from"node:async_hooks";var xr=(t=>(t[t.AggregateError=1]="AggregateError",t[t.ArrowFunction=2]="ArrowFunction",t[t.ErrorPrototypeStack=4]="ErrorPrototypeStack",t[t.ObjectAssign=8]="ObjectAssign",t[t.BigIntTypedArray=16]="BigIntTypedArray",t))(xr||{});function E(t,e){if(!t)throw e}function Pr(t){switch(t){case'"':return'\\"';case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"\b":return"\\b";case"	":return"\\t";case"\f":return"\\f";case"<":return"\\x3C";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return}}function R(t){let e="",r=0,s;for(let i=0,n=t.length;i<n;i++)s=Pr(t[i]),s&&(e+=t.slice(r,i)+s,r=i+1);return r===0?e=t:e+=t.slice(r),e}function Ir(t){switch(t){case"\\\\":return"\\";case'\\"':return'"';case"\\n":return`
`;case"\\r":return"\r";case"\\b":return"\b";case"\\t":return"	";case"\\f":return"\f";case"\\x3C":return"<";case"\\u2028":return"\u2028";case"\\u2029":return"\u2029";default:return t}}function O(t){return t.replace(/(\\\\|\\"|\\n|\\r|\\b|\\t|\\f|\\u2028|\\u2029|\\x3C)/g,Ir)}var _="__SEROVAL_REFS__",Y="$R",Z=`self.${Y}`;function kr(t){return t==null?`${Z}=${Z}||[]`:`(${Z}=${Z}||{})["${R(t)}"]=[]`}var ft=new Map,j=new Map;function be(t){return ft.has(t)}function Fr(t){return j.has(t)}function Cr(t){return E(be(t),new vs(t)),ft.get(t)}function Or(t){return E(Fr(t),new ys(t)),j.get(t)}typeof globalThis<"u"?Object.defineProperty(globalThis,_,{value:j,configurable:!0,writable:!1,enumerable:!1}):typeof window<"u"?Object.defineProperty(window,_,{value:j,configurable:!0,writable:!1,enumerable:!1}):typeof self<"u"?Object.defineProperty(self,_,{value:j,configurable:!0,writable:!1,enumerable:!1}):typeof global<"u"&&Object.defineProperty(global,_,{value:j,configurable:!0,writable:!1,enumerable:!1});function pt(t,e){for(let r=0,s=e.length;r<s;r++){let i=e[r];t.has(i)||(t.add(i),i.extends&&pt(t,i.extends))}}function mt(t){if(t){let e=new Set;return pt(e,t),[...e]}}var $r={0:"Symbol.asyncIterator",1:"Symbol.hasInstance",2:"Symbol.isConcatSpreadable",3:"Symbol.iterator",4:"Symbol.match",5:"Symbol.matchAll",6:"Symbol.replace",7:"Symbol.search",8:"Symbol.species",9:"Symbol.split",10:"Symbol.toPrimitive",11:"Symbol.toStringTag",12:"Symbol.unscopables"},gt={[Symbol.asyncIterator]:0,[Symbol.hasInstance]:1,[Symbol.isConcatSpreadable]:2,[Symbol.iterator]:3,[Symbol.match]:4,[Symbol.matchAll]:5,[Symbol.replace]:6,[Symbol.search]:7,[Symbol.species]:8,[Symbol.split]:9,[Symbol.toPrimitive]:10,[Symbol.toStringTag]:11,[Symbol.unscopables]:12},Tr={0:Symbol.asyncIterator,1:Symbol.hasInstance,2:Symbol.isConcatSpreadable,3:Symbol.iterator,4:Symbol.match,5:Symbol.matchAll,6:Symbol.replace,7:Symbol.search,8:Symbol.species,9:Symbol.split,10:Symbol.toPrimitive,11:Symbol.toStringTag,12:Symbol.unscopables},jr={2:"!0",3:"!1",1:"void 0",0:"null",4:"-0",5:"1/0",6:"-1/0",7:"0/0"},Lr={2:!0,3:!1,1:void 0,0:null,4:-0,5:1/0,6:-1/0,7:NaN},vt={0:"Error",1:"EvalError",2:"RangeError",3:"ReferenceError",4:"SyntaxError",5:"TypeError",6:"URIError"},Nr={0:Error,1:EvalError,2:RangeError,3:ReferenceError,4:SyntaxError,5:TypeError,6:URIError};function k(t){return{t:2,i:void 0,s:t,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}var we=k(2),Se=k(3),Vr=k(1),Dr=k(0),_r=k(4),Mr=k(5),qr=k(6),Ur=k(7);function Ce(t){return t instanceof EvalError?1:t instanceof RangeError?2:t instanceof ReferenceError?3:t instanceof SyntaxError?4:t instanceof TypeError?5:t instanceof URIError?6:0}function Hr(t){let e=vt[Ce(t)];return t.name!==e?{name:t.name}:t.constructor.name!==e?{name:t.constructor.name}:{}}function qe(t,e){let r=Hr(t),s=Object.getOwnPropertyNames(t);for(let i=0,n=s.length,a;i<n;i++)a=s[i],a!=="name"&&a!=="message"&&(a==="stack"?e&4&&(r=r||{},r[a]=t[a]):(r=r||{},r[a]=t[a]));return r}function yt(t){return Object.isFrozen(t)?3:Object.isSealed(t)?2:Object.isExtensible(t)?0:1}function Br(t){switch(t){case 1/0:return Mr;case-1/0:return qr}return t!==t?Ur:Object.is(t,-0)?_r:{t:0,i:void 0,s:t,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function ze(t){return{t:1,i:void 0,s:R(t),l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Wr(t){return{t:3,i:void 0,s:""+t,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Kr(t){return{t:4,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Xr(t,e){return{t:5,i:t,s:e.toISOString(),l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,f:void 0,a:void 0,b:void 0,o:void 0}}function Jr(t,e){return{t:6,i:t,s:void 0,l:void 0,c:R(e.source),m:e.flags,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Gr(t,e){let r=new Uint8Array(e),s=r.length,i=new Array(s);for(let n=0;n<s;n++)i[n]=r[n];return{t:19,i:t,s:i,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Zr(t,e){return{t:17,i:t,s:gt[e],l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Ue(t,e){return{t:18,i:t,s:R(Cr(e)),l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function bt(t,e,r){return{t:25,i:t,s:r,l:void 0,c:R(e),m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function Qr(t,e,r){return{t:9,i:t,s:void 0,l:e.length,c:void 0,m:void 0,p:void 0,e:void 0,a:r,f:void 0,b:void 0,o:yt(e)}}function Yr(t,e){return{t:21,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:e,b:void 0,o:void 0}}function es(t,e,r){return{t:15,i:t,s:void 0,l:e.length,c:e.constructor.name,m:void 0,p:void 0,e:void 0,a:void 0,f:r,b:e.byteOffset,o:void 0}}function ts(t,e,r){return{t:16,i:t,s:void 0,l:e.length,c:e.constructor.name,m:void 0,p:void 0,e:void 0,a:void 0,f:r,b:e.byteOffset,o:void 0}}function rs(t,e,r){return{t:20,i:t,s:void 0,l:e.byteLength,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:r,b:e.byteOffset,o:void 0}}function ss(t,e,r){return{t:13,i:t,s:Ce(e),l:void 0,c:void 0,m:R(e.message),p:r,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function is(t,e,r){return{t:14,i:t,s:Ce(e),l:void 0,c:void 0,m:R(e.message),p:r,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}function ns(t,e,r){return{t:7,i:t,s:void 0,l:e,c:void 0,m:void 0,p:void 0,e:void 0,a:r,f:void 0,b:void 0,o:void 0}}function wt(t,e){return{t:28,i:void 0,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[t,e],f:void 0,b:void 0,o:void 0}}function St(t,e){return{t:30,i:void 0,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[t,e],f:void 0,b:void 0,o:void 0}}function zt(t,e,r){return{t:31,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:r,f:e,b:void 0,o:void 0}}function as(t,e){return{t:32,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:e,b:void 0,o:void 0}}function os(t,e){return{t:33,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:e,b:void 0,o:void 0}}function ls(t,e){return{t:34,i:t,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:e,b:void 0,o:void 0}}function Rt(t){let e=[],r=-1,s=-1,i=t[Symbol.iterator]();for(;;)try{let n=i.next();if(e.push(n.value),n.done){s=e.length-1;break}}catch(n){r=e.length,e.push(n)}return{v:e,t:r,d:s}}function cs(t){return()=>{let e=0;return{[Symbol.iterator](){return this},next(){if(e>t.d)return{done:!0,value:void 0};let r=e++,s=t.v[r];if(r===t.t)throw s;return{done:r===t.d,value:s}}}}}var us={},ds={},hs={0:{},1:{},2:{},3:{},4:{}},{toString:Oe}=Object.prototype;function fs(t,e){return e instanceof Error?`Seroval caught an error during the ${t} process.
  
${e.name}
${e.message}

- For more information, please check the "cause" property of this error.
- If you believe this is an error in Seroval, please submit an issue at https://github.com/lxsmnsyc/seroval/issues/new`:`Seroval caught an error during the ${t} process.

"${Oe.call(e)}"

For more information, please check the "cause" property of this error.`}var $e=class extends Error{constructor(e,r){super(fs(e,r)),this.cause=r}},ps=class extends $e{constructor(t){super("parsing",t)}},ms=class extends $e{constructor(t){super("serialization",t)}},gs=class extends $e{constructor(t){super("deserialization",t)}},te=class extends Error{constructor(e){super(`The value ${Oe.call(e)} of type "${typeof e}" cannot be parsed/serialized.
      
There are few workarounds for this problem:
- Transform the value in a way that it can be serialized.
- If the reference is present on multiple runtimes (isomorphic), you can use the Reference API to map the references.`),this.value=e}},At=class extends Error{constructor(e){super('Unsupported node type "'+e.t+'".')}},Et=class extends Error{constructor(e){super('Missing plugin for tag "'+e+'".')}},V=class extends Error{constructor(e){super('Missing "'+e+'" instance.')}},vs=class extends Error{constructor(e){super('Missing reference for the value "'+Oe.call(e)+'" of type "'+typeof e+'"'),this.value=e}},ys=class extends Error{constructor(t){super('Missing reference for id "'+R(t)+'"')}},bs=class extends Error{constructor(t){super('Unknown TypedArray "'+t+'"')}},ws=class{constructor(e){this.marked=new Set,this.plugins=e.plugins,this.features=31^(e.disabledFeatures||0),this.refs=e.refs||new Map}markRef(e){this.marked.add(e)}isMarked(e){return this.marked.has(e)}getIndexedValue(e){let r=this.refs.get(e);if(r!=null)return this.markRef(r),{type:1,value:Kr(r)};let s=this.refs.size;return this.refs.set(e,s),{type:0,value:s}}getReference(e){let r=this.getIndexedValue(e);return r.type===1?r:be(e)?{type:2,value:Ue(r.value,e)}:r}getStrictReference(e){E(be(e),new te(e));let r=this.getIndexedValue(e);return r.type===1?r.value:Ue(r.value,e)}parseFunction(e){return this.getStrictReference(e)}parseWellKnownSymbol(e){let r=this.getReference(e);return r.type!==0?r.value:(E(e in gt,new te(e)),Zr(r.value,e))}parseSpecialReference(e){let r=this.getIndexedValue(hs[e]);return r.type===1?r.value:{t:26,i:r.value,s:e,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:void 0,b:void 0,o:void 0}}parseIteratorFactory(){let e=this.getIndexedValue(us);return e.type===1?e.value:{t:27,i:e.value,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:this.parseWellKnownSymbol(Symbol.iterator),b:void 0,o:void 0}}parseAsyncIteratorFactory(){let e=this.getIndexedValue(ds);return e.type===1?e.value:{t:29,i:e.value,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[this.parseSpecialReference(1),this.parseWellKnownSymbol(Symbol.asyncIterator)],f:void 0,b:void 0,o:void 0}}createObjectNode(e,r,s,i){return{t:s?11:10,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:i,e:void 0,a:void 0,f:void 0,b:void 0,o:yt(r)}}createMapNode(e,r,s,i){return{t:8,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:{k:r,v:s,s:i},a:void 0,f:this.parseSpecialReference(0),b:void 0,o:void 0}}createPromiseConstructorNode(e){return{t:22,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:void 0,f:this.parseSpecialReference(1),b:void 0,o:void 0}}};function Re(){let t,e;return{promise:new Promise((r,s)=>{t=r,e=s}),resolve(r){t(r)},reject(r){e(r)}}}function Ss(t){return"__SEROVAL_STREAM__"in t}function K(){let t=new Set,e=[],r=!0,s=!1;function i(o){for(let l of t.keys())l.next(o)}function n(o){for(let l of t.keys())l.throw(o)}function a(o){for(let l of t.keys())l.return(o)}return{__SEROVAL_STREAM__:!0,on(o){r&&t.add(o);for(let l=0,c=e.length;l<c;l++){let d=e[l];l===c-1?s?o.return(d):o.throw(d):o.next(d)}return()=>{r&&t.delete(o)}},next(o){r&&(e.push(o),i(o))},throw(o){r&&(e.push(o),n(o),r=!1,s=!1,t.clear())},return(o){r&&(e.push(o),a(o),r=!1,s=!0,t.clear())}}}function zs(t){let e=K(),r=t[Symbol.asyncIterator]();async function s(){try{let i=await r.next();i.done?e.return(i.value):(e.next(i.value),await s())}catch(i){e.throw(i)}}return s().catch(()=>{}),e}function Rs(t){return()=>{let e=[],r=[],s=0,i=-1,n=!1;function a(){for(let l=0,c=r.length;l<c;l++)r[l].resolve({done:!0,value:void 0})}t.on({next(l){let c=r.shift();c&&c.resolve({done:!1,value:l}),e.push(l)},throw(l){let c=r.shift();c&&c.reject(l),a(),i=e.length,e.push(l),n=!0},return(l){let c=r.shift();c&&c.resolve({done:!0,value:l}),a(),i=e.length,e.push(l)}});function o(){let l=s++,c=e[l];if(l!==i)return{done:!1,value:c};if(n)throw c;return{done:!0,value:c}}return{[Symbol.asyncIterator](){return this},async next(){if(i===-1){let l=s++;if(l>=e.length){let c=Re();return r.push(c),await c.promise}return{done:!1,value:e[l]}}return s>i?{done:!0,value:void 0}:o()}}}}function As(t){switch(t){case"Int8Array":return Int8Array;case"Int16Array":return Int16Array;case"Int32Array":return Int32Array;case"Uint8Array":return Uint8Array;case"Uint16Array":return Uint16Array;case"Uint32Array":return Uint32Array;case"Uint8ClampedArray":return Uint8ClampedArray;case"Float32Array":return Float32Array;case"Float64Array":return Float64Array;case"BigInt64Array":return BigInt64Array;case"BigUint64Array":return BigUint64Array;default:throw new bs(t)}}function He(t,e){switch(e){case 3:return Object.freeze(t);case 1:return Object.preventExtensions(t);case 2:return Object.seal(t);default:return t}}var Es=class{constructor(e){this.plugins=e.plugins,this.refs=e.refs||new Map}deserializeReference(e){return this.assignIndexedValue(e.i,Or(O(e.s)))}deserializeArray(e){let r=e.l,s=this.assignIndexedValue(e.i,new Array(r)),i;for(let n=0;n<r;n++)i=e.a[n],i&&(s[n]=this.deserialize(i));return He(s,e.o),s}deserializeProperties(e,r){let s=e.s;if(s){let i=e.k,n=e.v;for(let a=0,o;a<s;a++)o=i[a],typeof o=="string"?r[O(o)]=this.deserialize(n[a]):r[this.deserialize(o)]=this.deserialize(n[a])}return r}deserializeObject(e){let r=this.assignIndexedValue(e.i,e.t===10?{}:Object.create(null));return this.deserializeProperties(e.p,r),He(r,e.o),r}deserializeDate(e){return this.assignIndexedValue(e.i,new Date(e.s))}deserializeRegExp(e){return this.assignIndexedValue(e.i,new RegExp(O(e.c),e.m))}deserializeSet(e){let r=this.assignIndexedValue(e.i,new Set),s=e.a;for(let i=0,n=e.l;i<n;i++)r.add(this.deserialize(s[i]));return r}deserializeMap(e){let r=this.assignIndexedValue(e.i,new Map),s=e.e.k,i=e.e.v;for(let n=0,a=e.e.s;n<a;n++)r.set(this.deserialize(s[n]),this.deserialize(i[n]));return r}deserializeArrayBuffer(e){let r=new Uint8Array(e.s);return this.assignIndexedValue(e.i,r.buffer)}deserializeTypedArray(e){let r=As(e.c),s=this.deserialize(e.f);return this.assignIndexedValue(e.i,new r(s,e.b,e.l))}deserializeDataView(e){let r=this.deserialize(e.f);return this.assignIndexedValue(e.i,new DataView(r,e.b,e.l))}deserializeDictionary(e,r){if(e.p){let s=this.deserializeProperties(e.p,{});Object.assign(r,s)}return r}deserializeAggregateError(e){let r=this.assignIndexedValue(e.i,new AggregateError([],O(e.m)));return this.deserializeDictionary(e,r)}deserializeError(e){let r=Nr[e.s],s=this.assignIndexedValue(e.i,new r(O(e.m)));return this.deserializeDictionary(e,s)}deserializePromise(e){let r=Re(),s=this.assignIndexedValue(e.i,r),i=this.deserialize(e.f);return e.s?r.resolve(i):r.reject(i),s.promise}deserializeBoxed(e){return this.assignIndexedValue(e.i,Object(this.deserialize(e.f)))}deserializePlugin(e){let r=this.plugins;if(r){let s=O(e.c);for(let i=0,n=r.length;i<n;i++){let a=r[i];if(a.tag===s)return this.assignIndexedValue(e.i,a.deserialize(e.s,this,{id:e.i}))}}throw new Et(e.c)}deserializePromiseConstructor(e){return this.assignIndexedValue(e.i,Re()).promise}deserializePromiseResolve(e){let r=this.refs.get(e.i);E(r,new V("Promise")),r.resolve(this.deserialize(e.a[1]))}deserializePromiseReject(e){let r=this.refs.get(e.i);E(r,new V("Promise")),r.reject(this.deserialize(e.a[1]))}deserializeIteratorFactoryInstance(e){this.deserialize(e.a[0]);let r=this.deserialize(e.a[1]);return cs(r)}deserializeAsyncIteratorFactoryInstance(e){this.deserialize(e.a[0]);let r=this.deserialize(e.a[1]);return Rs(r)}deserializeStreamConstructor(e){let r=this.assignIndexedValue(e.i,K()),s=e.a.length;if(s)for(let i=0;i<s;i++)this.deserialize(e.a[i]);return r}deserializeStreamNext(e){let r=this.refs.get(e.i);E(r,new V("Stream")),r.next(this.deserialize(e.f))}deserializeStreamThrow(e){let r=this.refs.get(e.i);E(r,new V("Stream")),r.throw(this.deserialize(e.f))}deserializeStreamReturn(e){let r=this.refs.get(e.i);E(r,new V("Stream")),r.return(this.deserialize(e.f))}deserializeIteratorFactory(e){this.deserialize(e.f)}deserializeAsyncIteratorFactory(e){this.deserialize(e.a[1])}deserialize(e){try{switch(e.t){case 2:return Lr[e.s];case 0:return e.s;case 1:return O(e.s);case 3:return BigInt(e.s);case 4:return this.refs.get(e.i);case 18:return this.deserializeReference(e);case 9:return this.deserializeArray(e);case 10:case 11:return this.deserializeObject(e);case 5:return this.deserializeDate(e);case 6:return this.deserializeRegExp(e);case 7:return this.deserializeSet(e);case 8:return this.deserializeMap(e);case 19:return this.deserializeArrayBuffer(e);case 16:case 15:return this.deserializeTypedArray(e);case 20:return this.deserializeDataView(e);case 14:return this.deserializeAggregateError(e);case 13:return this.deserializeError(e);case 12:return this.deserializePromise(e);case 17:return Tr[e.s];case 21:return this.deserializeBoxed(e);case 25:return this.deserializePlugin(e);case 22:return this.deserializePromiseConstructor(e);case 23:return this.deserializePromiseResolve(e);case 24:return this.deserializePromiseReject(e);case 28:return this.deserializeIteratorFactoryInstance(e);case 30:return this.deserializeAsyncIteratorFactoryInstance(e);case 31:return this.deserializeStreamConstructor(e);case 32:return this.deserializeStreamNext(e);case 33:return this.deserializeStreamThrow(e);case 34:return this.deserializeStreamReturn(e);case 27:return this.deserializeIteratorFactory(e);case 29:return this.deserializeAsyncIteratorFactory(e);default:throw new At(e)}}catch(r){throw new gs(r)}}},xs=class extends Es{constructor(e){super(e),this.mode="vanilla",this.marked=new Set(e.markedRefs)}assignIndexedValue(e,r){return this.marked.has(e)&&this.refs.set(e,r),r}},Ps=/^[$A-Z_][0-9A-Z_$]*$/i;function Be(t){let e=t[0];return(e==="$"||e==="_"||e>="A"&&e<="Z"||e>="a"&&e<="z")&&Ps.test(t)}function M(t){switch(t.t){case 0:return t.s+"="+t.v;case 2:return t.s+".set("+t.k+","+t.v+")";case 1:return t.s+".add("+t.v+")";case 3:return t.s+".delete("+t.k+")"}}function Is(t){let e=[],r=t[0];for(let s=1,i=t.length,n,a=r;s<i;s++)n=t[s],n.t===0&&n.v===a.v?r={t:0,s:n.s,k:void 0,v:M(r)}:n.t===2&&n.s===a.s?r={t:2,s:M(r),k:n.k,v:n.v}:n.t===1&&n.s===a.s?r={t:1,s:M(r),k:void 0,v:n.v}:n.t===3&&n.s===a.s?r={t:3,s:M(r),k:n.k,v:void 0}:(e.push(r),r=n),a=n;return e.push(r),e}function We(t){if(t.length){let e="",r=Is(t);for(let s=0,i=r.length;s<i;s++)e+=M(r[s])+",";return e}}var ks="Object.create(null)",Fs="new Set",Cs="new Map",Os="Promise.resolve",$s="Promise.reject",Ts={3:"Object.freeze",2:"Object.seal",1:"Object.preventExtensions",0:void 0},js=class{constructor(t){this.stack=[],this.flags=[],this.assignments=[],this.plugins=t.plugins,this.features=t.features,this.marked=new Set(t.markedRefs)}createFunction(t,e){return this.features&2?(t.length===1?t[0]:"("+t.join(",")+")")+"=>"+e:"function("+t.join(",")+"){return "+e+"}"}createEffectfulFunction(t,e){return this.features&2?(t.length===1?t[0]:"("+t.join(",")+")")+"=>{"+e+"}":"function("+t.join(",")+"){"+e+"}"}markRef(t){this.marked.add(t)}isMarked(t){return this.marked.has(t)}pushObjectFlag(t,e){t!==0&&(this.markRef(e),this.flags.push({type:t,value:this.getRefParam(e)}))}resolveFlags(){let t="";for(let e=0,r=this.flags,s=r.length;e<s;e++){let i=r[e];t+=Ts[i.type]+"("+i.value+"),"}return t}resolvePatches(){let t=We(this.assignments),e=this.resolveFlags();return t?e?t+e:t:e}createAssignment(t,e){this.assignments.push({t:0,s:t,k:void 0,v:e})}createAddAssignment(t,e){this.assignments.push({t:1,s:this.getRefParam(t),k:void 0,v:e})}createSetAssignment(t,e,r){this.assignments.push({t:2,s:this.getRefParam(t),k:e,v:r})}createDeleteAssignment(t,e){this.assignments.push({t:3,s:this.getRefParam(t),k:e,v:void 0})}createArrayAssign(t,e,r){this.createAssignment(this.getRefParam(t)+"["+e+"]",r)}createObjectAssign(t,e,r){this.createAssignment(this.getRefParam(t)+"."+e,r)}isIndexedValueInStack(t){return t.t===4&&this.stack.includes(t.i)}serializeReference(t){return this.assignIndexedValue(t.i,_+'.get("'+t.s+'")')}serializeArrayItem(t,e,r){return e?this.isIndexedValueInStack(e)?(this.markRef(t),this.createArrayAssign(t,r,this.getRefParam(e.i)),""):this.serialize(e):""}serializeArray(t){let e=t.i;if(t.l){this.stack.push(e);let r=t.a,s=this.serializeArrayItem(e,r[0],0),i=s==="";for(let n=1,a=t.l,o;n<a;n++)o=this.serializeArrayItem(e,r[n],n),s+=","+o,i=o==="";return this.stack.pop(),this.pushObjectFlag(t.o,t.i),this.assignIndexedValue(e,"["+s+(i?",]":"]"))}return this.assignIndexedValue(e,"[]")}serializeProperty(t,e,r){if(typeof e=="string"){let s=Number(e),i=s>=0&&s.toString()===e||Be(e);if(this.isIndexedValueInStack(r)){let n=this.getRefParam(r.i);return this.markRef(t.i),i&&s!==s?this.createObjectAssign(t.i,e,n):this.createArrayAssign(t.i,i?e:'"'+e+'"',n),""}return(i?e:'"'+e+'"')+":"+this.serialize(r)}return"["+this.serialize(e)+"]:"+this.serialize(r)}serializeProperties(t,e){let r=e.s;if(r){let s=e.k,i=e.v;this.stack.push(t.i);let n=this.serializeProperty(t,s[0],i[0]);for(let a=1,o=n;a<r;a++)o=this.serializeProperty(t,s[a],i[a]),n+=(o&&n&&",")+o;return this.stack.pop(),"{"+n+"}"}return"{}"}serializeObject(t){return this.pushObjectFlag(t.o,t.i),this.assignIndexedValue(t.i,this.serializeProperties(t,t.p))}serializeWithObjectAssign(t,e,r){let s=this.serializeProperties(t,e);return s!=="{}"?"Object.assign("+r+","+s+")":r}serializeStringKeyAssignment(t,e,r,s){let i=this.serialize(s),n=Number(r),a=n>=0&&n.toString()===r||Be(r);if(this.isIndexedValueInStack(s))a&&n!==n?this.createObjectAssign(t.i,r,i):this.createArrayAssign(t.i,a?r:'"'+r+'"',i);else{let o=this.assignments;this.assignments=e,a&&n!==n?this.createObjectAssign(t.i,r,i):this.createArrayAssign(t.i,a?r:'"'+r+'"',i),this.assignments=o}}serializeAssignment(t,e,r,s){if(typeof r=="string")this.serializeStringKeyAssignment(t,e,r,s);else{let i=this.stack;this.stack=[];let n=this.serialize(s);this.stack=i;let a=this.assignments;this.assignments=e,this.createArrayAssign(t.i,this.serialize(r),n),this.assignments=a}}serializeAssignments(t,e){let r=e.s;if(r){let s=[],i=e.k,n=e.v;this.stack.push(t.i);for(let a=0;a<r;a++)this.serializeAssignment(t,s,i[a],n[a]);return this.stack.pop(),We(s)}}serializeDictionary(t,e){if(t.p)if(this.features&8)e=this.serializeWithObjectAssign(t,t.p,e);else{this.markRef(t.i);let r=this.serializeAssignments(t,t.p);if(r)return"("+this.assignIndexedValue(t.i,e)+","+r+this.getRefParam(t.i)+")"}return this.assignIndexedValue(t.i,e)}serializeNullConstructor(t){return this.pushObjectFlag(t.o,t.i),this.serializeDictionary(t,ks)}serializeDate(t){return this.assignIndexedValue(t.i,'new Date("'+t.s+'")')}serializeRegExp(t){return this.assignIndexedValue(t.i,"/"+t.c+"/"+t.m)}serializeSetItem(t,e){return this.isIndexedValueInStack(e)?(this.markRef(t),this.createAddAssignment(t,this.getRefParam(e.i)),""):this.serialize(e)}serializeSet(t){let e=Fs,r=t.l,s=t.i;if(r){let i=t.a;this.stack.push(s);let n=this.serializeSetItem(s,i[0]);for(let a=1,o=n;a<r;a++)o=this.serializeSetItem(s,i[a]),n+=(o&&n&&",")+o;this.stack.pop(),n&&(e+="(["+n+"])")}return this.assignIndexedValue(s,e)}serializeMapEntry(t,e,r,s){if(this.isIndexedValueInStack(e)){let i=this.getRefParam(e.i);if(this.markRef(t),this.isIndexedValueInStack(r)){let a=this.getRefParam(r.i);return this.createSetAssignment(t,i,a),""}if(r.t!==4&&r.i!=null&&this.isMarked(r.i)){let a="("+this.serialize(r)+",["+s+","+s+"])";return this.createSetAssignment(t,i,this.getRefParam(r.i)),this.createDeleteAssignment(t,s),a}let n=this.stack;return this.stack=[],this.createSetAssignment(t,i,this.serialize(r)),this.stack=n,""}if(this.isIndexedValueInStack(r)){let i=this.getRefParam(r.i);if(this.markRef(t),e.t!==4&&e.i!=null&&this.isMarked(e.i)){let a="("+this.serialize(e)+",["+s+","+s+"])";return this.createSetAssignment(t,this.getRefParam(e.i),i),this.createDeleteAssignment(t,s),a}let n=this.stack;return this.stack=[],this.createSetAssignment(t,this.serialize(e),i),this.stack=n,""}return"["+this.serialize(e)+","+this.serialize(r)+"]"}serializeMap(t){let e=Cs,r=t.e.s,s=t.i,i=t.f,n=this.getRefParam(i.i);if(r){let a=t.e.k,o=t.e.v;this.stack.push(s);let l=this.serializeMapEntry(s,a[0],o[0],n);for(let c=1,d=l;c<r;c++)d=this.serializeMapEntry(s,a[c],o[c],n),l+=(d&&l&&",")+d;this.stack.pop(),l&&(e+="(["+l+"])")}return i.t===26&&(this.markRef(i.i),e="("+this.serialize(i)+","+e+")"),this.assignIndexedValue(s,e)}serializeArrayBuffer(t){let e="new Uint8Array(",r=t.s,s=r.length;if(s){e+="["+r[0];for(let i=1;i<s;i++)e+=","+r[i];e+="]"}return this.assignIndexedValue(t.i,e+").buffer")}serializeTypedArray(t){return this.assignIndexedValue(t.i,"new "+t.c+"("+this.serialize(t.f)+","+t.b+","+t.l+")")}serializeDataView(t){return this.assignIndexedValue(t.i,"new DataView("+this.serialize(t.f)+","+t.b+","+t.l+")")}serializeAggregateError(t){let e=t.i;this.stack.push(e);let r=this.serializeDictionary(t,'new AggregateError([],"'+t.m+'")');return this.stack.pop(),r}serializeError(t){return this.serializeDictionary(t,"new "+vt[t.s]+'("'+t.m+'")')}serializePromise(t){let e,r=t.f,s=t.i,i=t.s?Os:$s;if(this.isIndexedValueInStack(r)){let n=this.getRefParam(r.i);e=i+(t.s?"().then("+this.createFunction([],n)+")":"().catch("+this.createEffectfulFunction([],"throw "+n)+")")}else{this.stack.push(s);let n=this.serialize(r);this.stack.pop(),e=i+"("+n+")"}return this.assignIndexedValue(s,e)}serializeWellKnownSymbol(t){return this.assignIndexedValue(t.i,$r[t.s])}serializeBoxed(t){return this.assignIndexedValue(t.i,"Object("+this.serialize(t.f)+")")}serializePlugin(t){let e=this.plugins;if(e)for(let r=0,s=e.length;r<s;r++){let i=e[r];if(i.tag===t.c)return this.assignIndexedValue(t.i,i.serialize(t.s,this,{id:t.i}))}throw new Et(t.c)}getConstructor(t){let e=this.serialize(t);return e===this.getRefParam(t.i)?e:"("+e+")"}serializePromiseConstructor(t){return this.assignIndexedValue(t.i,this.getConstructor(t.f)+"()")}serializePromiseResolve(t){return this.getConstructor(t.a[0])+"("+this.getRefParam(t.i)+","+this.serialize(t.a[1])+")"}serializePromiseReject(t){return this.getConstructor(t.a[0])+"("+this.getRefParam(t.i)+","+this.serialize(t.a[1])+")"}serializeSpecialReferenceValue(t){switch(t){case 0:return"[]";case 1:return this.createFunction(["s","f","p"],"((p=new Promise("+this.createEffectfulFunction(["a","b"],"s=a,f=b")+")).s=s,p.f=f,p)");case 2:return this.createEffectfulFunction(["p","d"],'p.s(d),p.status="success",p.value=d;delete p.s;delete p.f');case 3:return this.createEffectfulFunction(["p","d"],'p.f(d),p.status="failure",p.value=d;delete p.s;delete p.f');case 4:return this.createFunction(["b","a","s","l","p","f","e","n"],"(b=[],a=!0,s=!1,l=[],p=0,f="+this.createEffectfulFunction(["v","m","x"],"for(x=0;x<p;x++)l[x]&&l[x][m](v)")+",n="+this.createEffectfulFunction(["o","x","z","c"],'for(x=0,z=b.length;x<z;x++)(c=b[x],x===z-1?o[s?"return":"throw"](c):o.next(c))')+",e="+this.createFunction(["o","t"],"(a&&(l[t=p++]=o),n(o),"+this.createEffectfulFunction([],"a&&(l[t]=void 0)")+")")+",{__SEROVAL_STREAM__:!0,on:"+this.createFunction(["o"],"e(o)")+",next:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"next"))')+",throw:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"throw"),a=s=!1,l.length=0)')+",return:"+this.createEffectfulFunction(["v"],'a&&(b.push(v),f(v,"return"),a=!1,s=!0,l.length=0)')+"})");default:return""}}serializeSpecialReference(t){return this.assignIndexedValue(t.i,this.serializeSpecialReferenceValue(t.s))}serializeIteratorFactory(t){let e="",r=!1;return t.f.t!==4&&(this.markRef(t.f.i),e="("+this.serialize(t.f)+",",r=!0),e+=this.assignIndexedValue(t.i,this.createFunction(["s"],this.createFunction(["i","c","d","t"],"(i=0,t={["+this.getRefParam(t.f.i)+"]:"+this.createFunction([],"t")+",next:"+this.createEffectfulFunction([],"if(i>s.d)return{done:!0,value:void 0};if(d=s.v[c=i++],c===s.t)throw d;return{done:c===s.d,value:d}")+"})"))),r&&(e+=")"),e}serializeIteratorFactoryInstance(t){return this.getConstructor(t.a[0])+"("+this.serialize(t.a[1])+")"}serializeAsyncIteratorFactory(t){let e=t.a[0],r=t.a[1],s="";e.t!==4&&(this.markRef(e.i),s+="("+this.serialize(e)),r.t!==4&&(this.markRef(r.i),s+=(s?",":"(")+this.serialize(r)),s&&(s+=",");let i=this.assignIndexedValue(t.i,this.createFunction(["s"],this.createFunction(["b","c","p","d","e","t","f"],"(b=[],c=0,p=[],d=-1,e=!1,f="+this.createEffectfulFunction(["i","l"],"for(i=0,l=p.length;i<l;i++)p[i].s({done:!0,value:void 0})")+",s.on({next:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.s({done:!1,value:v});b.push(v)")+",throw:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.f(v);f(),d=b.length,e=!0,b.push(v)")+",return:"+this.createEffectfulFunction(["v","t"],"if(t=p.shift())t.s({done:!0,value:v});f(),d=b.length,b.push(v)")+"}),t={["+this.getRefParam(r.i)+"]:"+this.createFunction([],"t")+",next:"+this.createEffectfulFunction(["i","t","v"],"if(d===-1){return((i=c++)>=b.length)?(p.push(t="+this.getRefParam(e.i)+"()),t):{done:!0,value:b[i]}}if(c>d)return{done:!0,value:void 0};if(v=b[i=c++],i!==d)return{done:!1,value:v};if(e)throw v;return{done:!0,value:v}")+"})")));return s?s+i+")":i}serializeAsyncIteratorFactoryInstance(t){return this.getConstructor(t.a[0])+"("+this.serialize(t.a[1])+")"}serializeStreamConstructor(t){let e=this.assignIndexedValue(t.i,this.getConstructor(t.f)+"()"),r=t.a.length;if(r){let s=this.serialize(t.a[0]);for(let i=1;i<r;i++)s+=","+this.serialize(t.a[i]);return"("+e+","+s+","+this.getRefParam(t.i)+")"}return e}serializeStreamNext(t){return this.getRefParam(t.i)+".next("+this.serialize(t.f)+")"}serializeStreamThrow(t){return this.getRefParam(t.i)+".throw("+this.serialize(t.f)+")"}serializeStreamReturn(t){return this.getRefParam(t.i)+".return("+this.serialize(t.f)+")"}serialize(t){try{switch(t.t){case 2:return jr[t.s];case 0:return""+t.s;case 1:return'"'+t.s+'"';case 3:return t.s+"n";case 4:return this.getRefParam(t.i);case 18:return this.serializeReference(t);case 9:return this.serializeArray(t);case 10:return this.serializeObject(t);case 11:return this.serializeNullConstructor(t);case 5:return this.serializeDate(t);case 6:return this.serializeRegExp(t);case 7:return this.serializeSet(t);case 8:return this.serializeMap(t);case 19:return this.serializeArrayBuffer(t);case 16:case 15:return this.serializeTypedArray(t);case 20:return this.serializeDataView(t);case 14:return this.serializeAggregateError(t);case 13:return this.serializeError(t);case 12:return this.serializePromise(t);case 17:return this.serializeWellKnownSymbol(t);case 21:return this.serializeBoxed(t);case 22:return this.serializePromiseConstructor(t);case 23:return this.serializePromiseResolve(t);case 24:return this.serializePromiseReject(t);case 25:return this.serializePlugin(t);case 26:return this.serializeSpecialReference(t);case 27:return this.serializeIteratorFactory(t);case 28:return this.serializeIteratorFactoryInstance(t);case 29:return this.serializeAsyncIteratorFactory(t);case 30:return this.serializeAsyncIteratorFactoryInstance(t);case 31:return this.serializeStreamConstructor(t);case 32:return this.serializeStreamNext(t);case 33:return this.serializeStreamThrow(t);case 34:return this.serializeStreamReturn(t);default:throw new At(t)}}catch(e){throw new ms(e)}}},Ls=class extends ws{parseItems(e){let r=[];for(let s=0,i=e.length;s<i;s++)s in e&&(r[s]=this.parse(e[s]));return r}parseArray(e,r){return Qr(e,r,this.parseItems(r))}parseProperties(e){let r=Object.entries(e),s=[],i=[];for(let a=0,o=r.length;a<o;a++)s.push(R(r[a][0])),i.push(this.parse(r[a][1]));let n=Symbol.iterator;return n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(wt(this.parseIteratorFactory(),this.parse(Rt(e))))),n=Symbol.asyncIterator,n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(St(this.parseAsyncIteratorFactory(),this.parse(K())))),n=Symbol.toStringTag,n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(ze(e[n]))),n=Symbol.isConcatSpreadable,n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(e[n]?we:Se)),{k:s,v:i,s:s.length}}parsePlainObject(e,r,s){return this.createObjectNode(e,r,s,this.parseProperties(r))}parseBoxed(e,r){return Yr(e,this.parse(r.valueOf()))}parseTypedArray(e,r){return es(e,r,this.parse(r.buffer))}parseBigIntTypedArray(e,r){return ts(e,r,this.parse(r.buffer))}parseDataView(e,r){return rs(e,r,this.parse(r.buffer))}parseError(e,r){let s=qe(r,this.features);return ss(e,r,s?this.parseProperties(s):void 0)}parseAggregateError(e,r){let s=qe(r,this.features);return is(e,r,s?this.parseProperties(s):void 0)}parseMap(e,r){let s=[],i=[];for(let[n,a]of r.entries())s.push(this.parse(n)),i.push(this.parse(a));return this.createMapNode(e,s,i,r.size)}parseSet(e,r){let s=[];for(let i of r.keys())s.push(this.parse(i));return ns(e,r.size,s)}parsePlugin(e,r){let s=this.plugins;if(s)for(let i=0,n=s.length;i<n;i++){let a=s[i];if(a.parse.sync&&a.test(r))return bt(e,a.tag,a.parse.sync(r,this,{id:e}))}}parseStream(e,r){return zt(e,this.parseSpecialReference(4),[])}parsePromise(e,r){return this.createPromiseConstructorNode(e)}parseObject(e,r){if(Array.isArray(r))return this.parseArray(e,r);if(Ss(r))return this.parseStream(e,r);let s=this.parsePlugin(e,r);if(s)return s;let i=r.constructor;switch(i){case Object:return this.parsePlainObject(e,r,!1);case void 0:return this.parsePlainObject(e,r,!0);case Date:return Xr(e,r);case RegExp:return Jr(e,r);case Error:case EvalError:case RangeError:case ReferenceError:case SyntaxError:case TypeError:case URIError:return this.parseError(e,r);case Number:case Boolean:case String:case BigInt:return this.parseBoxed(e,r);case ArrayBuffer:return Gr(e,r);case Int8Array:case Int16Array:case Int32Array:case Uint8Array:case Uint16Array:case Uint32Array:case Uint8ClampedArray:case Float32Array:case Float64Array:return this.parseTypedArray(e,r);case DataView:return this.parseDataView(e,r);case Map:return this.parseMap(e,r);case Set:return this.parseSet(e,r)}if(i===Promise||r instanceof Promise)return this.parsePromise(e,r);let n=this.features;if(n&16)switch(i){case BigInt64Array:case BigUint64Array:return this.parseBigIntTypedArray(e,r)}if(n&1&&typeof AggregateError<"u"&&(i===AggregateError||r instanceof AggregateError))return this.parseAggregateError(e,r);if(r instanceof Error)return this.parseError(e,r);if(Symbol.iterator in r||Symbol.asyncIterator in r)return this.parsePlainObject(e,r,!!i);throw new te(r)}parse(e){try{switch(typeof e){case"boolean":return e?we:Se;case"undefined":return Vr;case"string":return ze(e);case"number":return Br(e);case"bigint":return Wr(e);case"object":{if(e){let r=this.getReference(e);return r.type===0?this.parseObject(r.value,e):r.value}return Dr}case"symbol":return this.parseWellKnownSymbol(e);case"function":return this.parseFunction(e);default:throw new te(e)}}catch(r){throw new ps(r)}}};function Ns(t,e={}){let r=mt(e.plugins);return new xs({plugins:r,markedRefs:t.m}).deserialize(t.t)}var Vs=class extends js{constructor(e){super(e),this.mode="cross",this.scopeId=e.scopeId}getRefParam(e){return Y+"["+e+"]"}assignIndexedValue(e,r){return this.getRefParam(e)+"="+r}serializeTop(e){let r=this.serialize(e),s=e.i;if(s==null)return r;let i=this.resolvePatches(),n=this.getRefParam(s),a=this.scopeId==null?"":Y,o=i?r+","+i+n:r;if(a==="")return i?"("+o+")":o;let l=this.scopeId==null?"()":"("+Y+'["'+R(this.scopeId)+'"])';return"("+this.createFunction([a],o)+")"+l}},Ds=class extends Ls{constructor(e){super(e),this.alive=!0,this.pending=0,this.initial=!0,this.buffer=[],this.onParseCallback=e.onParse,this.onErrorCallback=e.onError,this.onDoneCallback=e.onDone}onParseInternal(e,r){try{this.onParseCallback(e,r)}catch(s){this.onError(s)}}flush(){for(let e=0,r=this.buffer.length;e<r;e++)this.onParseInternal(this.buffer[e],!1)}onParse(e){this.initial?this.buffer.push(e):this.onParseInternal(e,!1)}onError(e){if(this.onErrorCallback)this.onErrorCallback(e);else throw e}onDone(){this.onDoneCallback&&this.onDoneCallback()}pushPendingState(){this.pending++}popPendingState(){--this.pending<=0&&this.onDone()}parseProperties(e){let r=Object.entries(e),s=[],i=[];for(let a=0,o=r.length;a<o;a++)s.push(R(r[a][0])),i.push(this.parse(r[a][1]));let n=Symbol.iterator;return n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(wt(this.parseIteratorFactory(),this.parse(Rt(e))))),n=Symbol.asyncIterator,n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(St(this.parseAsyncIteratorFactory(),this.parse(zs(e))))),n=Symbol.toStringTag,n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(ze(e[n]))),n=Symbol.isConcatSpreadable,n in e&&(s.push(this.parseWellKnownSymbol(n)),i.push(e[n]?we:Se)),{k:s,v:i,s:s.length}}parsePromise(e,r){return r.then(s=>{let i=this.parseWithError(s);i&&this.onParse({t:23,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[this.parseSpecialReference(2),i],f:void 0,b:void 0,o:void 0}),this.popPendingState()},s=>{if(this.alive){let i=this.parseWithError(s);i&&this.onParse({t:24,i:e,s:void 0,l:void 0,c:void 0,m:void 0,p:void 0,e:void 0,a:[this.parseSpecialReference(3),i],f:void 0,b:void 0,o:void 0})}this.popPendingState()}),this.pushPendingState(),this.createPromiseConstructorNode(e)}parsePlugin(e,r){let s=this.plugins;if(s)for(let i=0,n=s.length;i<n;i++){let a=s[i];if(a.parse.stream&&a.test(r))return bt(e,a.tag,a.parse.stream(r,this,{id:e}))}}parseStream(e,r){let s=zt(e,this.parseSpecialReference(4),[]);return this.pushPendingState(),r.on({next:i=>{if(this.alive){let n=this.parseWithError(i);n&&this.onParse(as(e,n))}},throw:i=>{if(this.alive){let n=this.parseWithError(i);n&&this.onParse(os(e,n))}this.popPendingState()},return:i=>{if(this.alive){let n=this.parseWithError(i);n&&this.onParse(ls(e,n))}this.popPendingState()}}),s}parseWithError(e){try{return this.parse(e)}catch(r){this.onError(r);return}}start(e){let r=this.parseWithError(e);r&&(this.onParseInternal(r,!0),this.initial=!1,this.flush(),this.pending<=0&&this.destroy())}destroy(){this.alive&&(this.onDone(),this.alive=!1)}isAlive(){return this.alive}},_s=class extends Ds{constructor(){super(...arguments),this.mode="cross"}};function Ms(t,e){let r=mt(e.plugins),s=new _s({plugins:r,refs:e.refs,disabledFeatures:e.disabledFeatures,onParse(i,n){let a=new Vs({plugins:r,features:s.features,scopeId:e.scopeId,markedRefs:s.marked}),o;try{o=a.serializeTop(i)}catch(l){e.onError&&e.onError(l);return}e.onSerialize(o,n)},onError:e.onError,onDone:e.onDone});return s.start(t),()=>{s.destroy()}}function ce(t){return{detail:t.detail,bubbles:t.bubbles,cancelable:t.cancelable,composed:t.composed}}var qs={tag:"seroval-plugins/web/CustomEvent",test(t){return typeof CustomEvent>"u"?!1:t instanceof CustomEvent},parse:{sync(t,e){return{type:e.parse(t.type),options:e.parse(ce(t))}},async async(t,e){return{type:await e.parse(t.type),options:await e.parse(ce(t))}},stream(t,e){return{type:e.parse(t.type),options:e.parse(ce(t))}}},serialize(t,e){return"new CustomEvent("+e.serialize(t.type)+","+e.serialize(t.options)+")"},deserialize(t,e){return new CustomEvent(e.deserialize(t.type),e.deserialize(t.options))}},xt=qs,Us={tag:"seroval-plugins/web/DOMException",test(t){return typeof DOMException>"u"?!1:t instanceof DOMException},parse:{sync(t,e){return{name:e.parse(t.name),message:e.parse(t.message)}},async async(t,e){return{name:await e.parse(t.name),message:await e.parse(t.message)}},stream(t,e){return{name:e.parse(t.name),message:e.parse(t.message)}}},serialize(t,e){return"new DOMException("+e.serialize(t.message)+","+e.serialize(t.name)+")"},deserialize(t,e){return new DOMException(e.deserialize(t.message),e.deserialize(t.name))}},Pt=Us;function ue(t){return{bubbles:t.bubbles,cancelable:t.cancelable,composed:t.composed}}var Hs={tag:"seroval-plugins/web/Event",test(t){return typeof Event>"u"?!1:t instanceof Event},parse:{sync(t,e){return{type:e.parse(t.type),options:e.parse(ue(t))}},async async(t,e){return{type:await e.parse(t.type),options:await e.parse(ue(t))}},stream(t,e){return{type:e.parse(t.type),options:e.parse(ue(t))}}},serialize(t,e){return"new Event("+e.serialize(t.type)+","+e.serialize(t.options)+")"},deserialize(t,e){return new Event(e.deserialize(t.type),e.deserialize(t.options))}},It=Hs,Bs={tag:"seroval-plugins/web/File",test(t){return typeof File>"u"?!1:t instanceof File},parse:{async async(t,e){return{name:await e.parse(t.name),options:await e.parse({type:t.type,lastModified:t.lastModified}),buffer:await e.parse(await t.arrayBuffer())}}},serialize(t,e){return"new File(["+e.serialize(t.buffer)+"],"+e.serialize(t.name)+","+e.serialize(t.options)+")"},deserialize(t,e){return new File([e.deserialize(t.buffer)],e.deserialize(t.name),e.deserialize(t.options))}},Ws=Bs;function de(t){let e=[];return t.forEach((r,s)=>{e.push([s,r])}),e}var q={},Ks={tag:"seroval-plugins/web/FormDataFactory",test(t){return t===q},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(t,e){return e.createEffectfulFunction(["e","f","i","s","t"],"f=new FormData;for(i=0,s=e.length;i<s;i++)f.append((t=e[i])[0],t[1]);return f")},deserialize(){return q}},Xs={tag:"seroval-plugins/web/FormData",extends:[Ws,Ks],test(t){return typeof FormData>"u"?!1:t instanceof FormData},parse:{sync(t,e){return{factory:e.parse(q),entries:e.parse(de(t))}},async async(t,e){return{factory:await e.parse(q),entries:await e.parse(de(t))}},stream(t,e){return{factory:e.parse(q),entries:e.parse(de(t))}}},serialize(t,e){return"("+e.serialize(t.factory)+")("+e.serialize(t.entries)+")"},deserialize(t,e){let r=new FormData,s=e.deserialize(t.entries);for(let i=0,n=s.length;i<n;i++){let a=s[i];r.append(a[0],a[1])}return r}},kt=Xs;function he(t){let e=[];return t.forEach((r,s)=>{e.push([s,r])}),e}var Js={tag:"seroval-plugins/web/Headers",test(t){return typeof Headers>"u"?!1:t instanceof Headers},parse:{sync(t,e){return e.parse(he(t))},async async(t,e){return await e.parse(he(t))},stream(t,e){return e.parse(he(t))}},serialize(t,e){return"new Headers("+e.serialize(t)+")"},deserialize(t,e){return new Headers(e.deserialize(t))}},ne=Js,U={},Gs={tag:"seroval-plugins/web/ReadableStreamFactory",test(t){return t===U},parse:{sync(){},async async(){return await Promise.resolve(void 0)},stream(){}},serialize(t,e){return e.createFunction(["d"],"new ReadableStream({start:"+e.createEffectfulFunction(["c"],"d.on({next:"+e.createEffectfulFunction(["v"],"c.enqueue(v)")+",throw:"+e.createEffectfulFunction(["v"],"c.error(v)")+",return:"+e.createEffectfulFunction([],"c.close()")+"})")+"})")},deserialize(){return U}};function Ke(t){let e=K(),r=t.getReader();async function s(){try{let i=await r.read();i.done?e.return(i.value):(e.next(i.value),await s())}catch(i){e.throw(i)}}return s().catch(()=>{}),e}var Zs={tag:"seroval/plugins/web/ReadableStream",extends:[Gs],test(t){return typeof ReadableStream>"u"?!1:t instanceof ReadableStream},parse:{sync(t,e){return{factory:e.parse(U),stream:e.parse(K())}},async async(t,e){return{factory:await e.parse(U),stream:await e.parse(Ke(t))}},stream(t,e){return{factory:e.parse(U),stream:e.parse(Ke(t))}}},serialize(t,e){return"("+e.serialize(t.factory)+")("+e.serialize(t.stream)+")"},deserialize(t,e){let r=e.deserialize(t.stream);return new ReadableStream({start(s){r.on({next(i){s.enqueue(i)},throw(i){s.error(i)},return(){s.close()}})}})}},ae=Zs;function Xe(t,e){return{body:e,cache:t.cache,credentials:t.credentials,headers:t.headers,integrity:t.integrity,keepalive:t.keepalive,method:t.method,mode:t.mode,redirect:t.redirect,referrer:t.referrer,referrerPolicy:t.referrerPolicy}}var Qs={tag:"seroval-plugins/web/Request",extends:[ae,ne],test(t){return typeof Request>"u"?!1:t instanceof Request},parse:{async async(t,e){return{url:await e.parse(t.url),options:await e.parse(Xe(t,t.body?await t.clone().arrayBuffer():null))}},stream(t,e){return{url:e.parse(t.url),options:e.parse(Xe(t,t.clone().body))}}},serialize(t,e){return"new Request("+e.serialize(t.url)+","+e.serialize(t.options)+")"},deserialize(t,e){return new Request(e.deserialize(t.url),e.deserialize(t.options))}},Ft=Qs;function Je(t){return{headers:t.headers,status:t.status,statusText:t.statusText}}var Ys={tag:"seroval-plugins/web/Response",extends:[ae,ne],test(t){return typeof Response>"u"?!1:t instanceof Response},parse:{async async(t,e){return{body:await e.parse(t.body?await t.clone().arrayBuffer():null),options:await e.parse(Je(t))}},stream(t,e){return{body:e.parse(t.clone().body),options:e.parse(Je(t))}}},serialize(t,e){return"new Response("+e.serialize(t.body)+","+e.serialize(t.options)+")"},deserialize(t,e){return new Response(e.deserialize(t.body),e.deserialize(t.options))}},Ct=Ys,ei={tag:"seroval-plugins/web/URLSearchParams",test(t){return typeof URLSearchParams>"u"?!1:t instanceof URLSearchParams},parse:{sync(t,e){return e.parse(t.toString())},async async(t,e){return await e.parse(t.toString())},stream(t,e){return e.parse(t.toString())}},serialize(t,e){return"new URLSearchParams("+e.serialize(t)+")"},deserialize(t,e){return new URLSearchParams(e.deserialize(t))}},Ot=ei,ti={tag:"seroval-plugins/web/URL",test(t){return typeof URL>"u"?!1:t instanceof URL},parse:{sync(t,e){return e.parse(t.href)},async async(t,e){return await e.parse(t.href)},stream(t,e){return e.parse(t.href)}},serialize(t,e){return"new URL("+e.serialize(t)+")"},deserialize(t,e){return new URL(e.deserialize(t))}},$t=ti;function ri(t={}){let e,r=!1;const s=a=>{if(e&&e!==a)throw new Error("Context conflict")};let i;if(t.asyncContext){const a=t.AsyncLocalStorage||globalThis.AsyncLocalStorage;a?i=new a:console.warn("[unctx] `AsyncLocalStorage` is not provided.")}const n=()=>{if(i&&e===void 0){const a=i.getStore();if(a!==void 0)return a}return e};return{use:()=>{const a=n();if(a===void 0)throw new Error("Context is not available");return a},tryUse:()=>n(),set:(a,o)=>{o||s(a),e=a,r=!0},unset:()=>{e=void 0,r=!1},call:(a,o)=>{s(a),e=a;try{return i?i.run(a,o):o()}finally{r||(e=void 0)}},async callAsync(a,o){e=a;const l=()=>{e=a},c=()=>e===a?l:void 0;Qe.add(c);try{const d=i?i.run(a,o):o();return r||(e=void 0),await d}finally{Qe.delete(c)}}}}function si(t={}){const e={};return{get(r,s={}){return e[r]||(e[r]=ri({...t,...s})),e[r],e[r]}}}const re=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof global<"u"?global:typeof window<"u"?window:{},Ge="__unctx__",ii=re[Ge]||(re[Ge]=si()),ni=(t,e={})=>ii.get(t,e),Ze="__unctx_async_handlers__",Qe=re[Ze]||(re[Ze]=new Set);function ai(t){let e;const r=Tt(t),s={duplex:"half",method:t.method,headers:t.headers};return t.node.req.body instanceof ArrayBuffer?new Request(r,{...s,body:t.node.req.body}):new Request(r,{...s,get body(){return e||(e=gi(t),e)}})}function oi(t){return t.web??={request:ai(t),url:Tt(t)},t.web.request}function li(){return wi()}const W=Symbol("$HTTPEvent");function ci(t){return typeof t=="object"&&(t instanceof ye||t?.[W]instanceof ye||t?.__is_event__===!0)}function S(t){return function(...e){let r=e[0];if(ci(r))e[0]=r instanceof ye||r.__is_event__?r:r[W];else{if(!globalThis.app.config.server.experimental?.asyncContext)throw new Error("AsyncLocalStorage was not enabled. Use the `server.experimental.asyncContext: true` option in your app configuration to enable it. Or, pass the instance of HTTPEvent that you have as the first argument to the function.");if(r=li(),!r)throw new Error("No HTTPEvent found in AsyncLocalStorage. Make sure you are using the function within the server runtime.");e.unshift(r)}return t(...e)}}const Tt=S(vr),ui=S(hr),Ae=S(ur),Ye=S(fr),di=S(pr),Q=S(yr),et=S(br),hi=S(wr),fi=S(Sr),pi=S(mr),mi=S(gr),jt=S(dr),gi=S(Rr),vi=S(zr),yi=S(oi);function bi(){return ni("nitro-app",{asyncContext:!!globalThis.app.config.server.experimental?.asyncContext,AsyncLocalStorage:Er})}function wi(){return bi().use().event}const fe="Invariant Violation",{setPrototypeOf:Si=function(t,e){return t.__proto__=e,t}}=Object;class Te extends Error{framesToPop=1;name=fe;constructor(e=fe){super(typeof e=="number"?`${fe}: ${e} (see https://github.com/apollographql/invariant-packages)`:e),Si(this,Te.prototype)}}function zi(t,e){if(!t)throw new Te(e)}const pe=Symbol("fetchEvent");function Ri(t){return{request:yi(t),response:Pi(t),clientAddress:ui(t),locals:{},nativeEvent:t,[W]:t}}function Ai(t){return{...t,[W]:t[W]}}function Ei(t){if(!t[pe]){const e=Ri(t);t[pe]=e}return t[pe]}function tt(t,e){for(const[r,s]of e.entries())jt(t,r,s)}class xi{constructor(e){this.event=e}get(e){const r=et(this.event,e);return Array.isArray(r)?r.join(", "):r}has(e){return this.get(e)!==void 0}set(e,r){return hi(this.event,e,r)}delete(e){return vi(this.event,e)}append(e,r){fi(this.event,e,r)}getSetCookie(){const e=et(this.event,"Set-Cookie");return Array.isArray(e)?e:[e]}forEach(e){return Object.entries(Q(this.event)).forEach(([r,s])=>e(Array.isArray(s)?s.join(", "):s,r,this))}entries(){return Object.entries(Q(this.event)).map(([e,r])=>[e,Array.isArray(r)?r.join(", "):r])[Symbol.iterator]()}keys(){return Object.keys(Q(this.event))[Symbol.iterator]()}values(){return Object.values(Q(this.event)).map(e=>Array.isArray(e)?e.join(", "):e)[Symbol.iterator]()}[Symbol.iterator](){return this.entries()[Symbol.iterator]()}}function Pi(t){return{get status(){return Ye(t)},set status(e){Ae(t,e)},get statusText(){return di(t)},set statusText(e){Ae(t,Ye(),e)},headers:new xi(t)}}function Ii(t){t.forEach(e=>{if(!e.attrs.href)return;let r=document.head.querySelector(`link[href="${e.attrs.href}"]`);r||(r=document.createElement("link"),r.setAttribute("rel","preload"),r.setAttribute("as","style"),r.setAttribute("href",e.attrs.href),document.head.appendChild(r))})}var ki=" ";const Fi={style:t=>le("style",t.attrs,()=>ve(t.children),!0),link:t=>le("link",t.attrs,void 0,!0),script:t=>t.attrs.src?le("script",ar(()=>t.attrs,{get id(){return t.key}}),()=>dt(ki),!0):null};function Ci(t){let{tag:e,attrs:{key:r,...s}={key:void 0},children:i}=t;return Fi[e]({attrs:s,key:r,children:i})}function Oi(t,e,r,s="default"){return er(async()=>{{const n=(await t.import())[s],o=(await e.inputs?.[t.src].assets()).filter(c=>c.tag==="style"||c.attrs.rel==="stylesheet");return typeof window<"u"&&Ii(o),{default:c=>[...o.map(d=>Ci(d)),it(n,c)]}}})}const L={NORMAL:0,WILDCARD:1,PLACEHOLDER:2};function $i(t={}){const e={options:t,rootNode:Lt(),staticRoutesMap:{}},r=s=>t.strictTrailingSlash?s:s.replace(/\/$/,"")||"/";if(t.routes)for(const s in t.routes)rt(e,r(s),t.routes[s]);return{ctx:e,lookup:s=>Ti(e,r(s)),insert:(s,i)=>rt(e,r(s),i),remove:s=>ji(e,r(s))}}function Ti(t,e){const r=t.staticRoutesMap[e];if(r)return r.data;const s=e.split("/"),i={};let n=!1,a=null,o=t.rootNode,l=null;for(let c=0;c<s.length;c++){const d=s[c];o.wildcardChildNode!==null&&(a=o.wildcardChildNode,l=s.slice(c).join("/"));const u=o.children.get(d);if(u!==void 0)o=u;else if(o=o.placeholderChildNode,o!==null)i[o.paramName]=d,n=!0;else break}return(o===null||o.data===null)&&a!==null&&(o=a,i[o.paramName||"_"]=l,n=!0),o?n?{...o.data,params:n?i:void 0}:o.data:null}function rt(t,e,r){let s=!0;const i=e.split("/");let n=t.rootNode,a=0;for(const o of i){let l;if(l=n.children.get(o))n=l;else{const c=Li(o);l=Lt({type:c,parent:n}),n.children.set(o,l),c===L.PLACEHOLDER?(l.paramName=o==="*"?`_${a++}`:o.slice(1),n.placeholderChildNode=l,s=!1):c===L.WILDCARD&&(n.wildcardChildNode=l,l.paramName=o.slice(3)||"_",s=!1),n=l}}return n.data=r,s===!0&&(t.staticRoutesMap[e]=n),n}function ji(t,e){let r=!1;const s=e.split("/");let i=t.rootNode;for(const n of s)if(i=i.children.get(n),!i)return r;if(i.data){const n=s[s.length-1];if(i.data=null,Object.keys(i.children).length===0){const a=i.parent;a.children.delete(n),a.wildcardChildNode=null,a.placeholderChildNode=null}r=!0}return r}function Lt(t={}){return{type:t.type||L.NORMAL,parent:t.parent||null,children:new Map,data:t.data||null,paramName:t.paramName||null,wildcardChildNode:null,placeholderChildNode:null}}function Li(t){return t.startsWith("**")?L.WILDCARD:t[0]===":"||t==="*"?L.PLACEHOLDER:L.NORMAL}const Nt=[{$component:{src:"src/routes/index.tsx?pick=default&pick=$css",build:()=>import("./index.js"),import:()=>import("./index.js")},path:"/",filePath:"D:/Dev/traffic/src/routes/index.tsx"},{$component:{src:"src/routes/[...404].tsx?pick=default&pick=$css",build:()=>import("./_...404_.js"),import:()=>import("./_...404_.js")},path:"/*404",filePath:"D:/Dev/traffic/src/routes/[...404].tsx"}],Ni=Vi(Nt.filter(t=>t.$component));function Vi(t){function e(r,s,i,n){const a=Object.values(r).find(o=>i.startsWith(o.id+"/"));return a?(e(a.children||(a.children=[]),s,i.slice(a.id.length)),r):(r.push({...s,id:i,path:i.replace(/\/\([^)/]+\)/g,"")}),r)}return t.sort((r,s)=>r.path.length-s.path.length).reduce((r,s)=>e(r,s,s.path,s.path),[])}function Di(t){return t.$GET||t.$POST||t.$PUT||t.$PATCH||t.$DELETE}$i({routes:Nt.reduce((t,e)=>{if(!Di(e))return t;let r=e.path.replace(/\(.*\)\/?/g,"").replace(/\*([^/]*)/g,(s,i)=>`**:${i}`);if(/:[^/]*\?/g.test(r))throw new Error(`Optional parameters are not supported in API routes: ${r}`);if(t[r])throw new Error(`Duplicate API routes for "${r}" found at "${t[r].route.path}" and "${e.path}"`);return t[r]={route:e},t},{})});function Vt(){function t(r){return{...r,...r.$$route?r.$$route.require().route:void 0,info:{...r.$$route?r.$$route.require().route.info:{},filesystem:!0},component:Oi(r.$component,globalThis.MANIFEST.client,globalThis.MANIFEST.ssr),children:r.children?r.children.map(t):void 0}}return Ni.map(t)}let st;const _i=()=>$?B().routes:st||(st=Vt());function Mi(t){const e=pi(t,"flash");if(!e)return;let r=JSON.parse(e);if(!r||!r.result)return[];const s=[...r.input.slice(0,-1),new Map(r.input[r.input.length-1])];return mi(t,"flash","",{maxAge:0}),{url:r.url,result:r.error?new Error(r.result):r.result,input:s}}async function qi(t){const e=globalThis.MANIFEST.client;return globalThis.MANIFEST.ssr,t.response.headers.set("Content-Type","text/html"),Object.assign(t,{manifest:await e.json(),assets:[...await e.inputs[e.handler].assets()],router:{submission:Mi(t)},routes:Vt(),$islands:new Set})}const Dt=Ie(),_t=["title","meta"],Ee=[],xe=["name","http-equiv","content","charset","media"].concat(["property"]),se=(t,e)=>{const r=Object.fromEntries(Object.entries(t.props).filter(([s])=>e.includes(s)).sort());return(Object.hasOwn(r,"name")||Object.hasOwn(r,"property"))&&(r.name=r.name||r.property,delete r.property),t.tag+JSON.stringify(r)};function Ui(){if(!Fe.context){const r=document.head.querySelectorAll("[data-sm]");Array.prototype.forEach.call(r,s=>s.parentNode.removeChild(s))}const t=new Map;function e(r){if(r.ref)return r.ref;let s=document.querySelector(`[data-sm="${r.id}"]`);return s?(s.tagName.toLowerCase()!==r.tag&&(s.parentNode&&s.parentNode.removeChild(s),s=document.createElement(r.tag)),s.removeAttribute("data-sm")):s=document.createElement(r.tag),s}return{addTag(r){if(_t.indexOf(r.tag)!==-1){const n=r.tag==="title"?Ee:xe,a=se(r,n);t.has(a)||t.set(a,[]);let o=t.get(a),l=o.length;o=[...o,r],t.set(a,o);let c=e(r);r.ref=c,Me(c,r.props);let d=null;for(var s=l-1;s>=0;s--)if(o[s]!=null){d=o[s];break}return c.parentNode!=document.head&&document.head.appendChild(c),d&&d.ref&&document.head.removeChild(d.ref),l}let i=e(r);return r.ref=i,Me(i,r.props),i.parentNode!=document.head&&document.head.appendChild(i),-1},removeTag(r,s){const i=r.tag==="title"?Ee:xe,n=se(r,i);if(r.ref){const a=t.get(n);if(a){if(r.ref.parentNode){r.ref.parentNode.removeChild(r.ref);for(let o=s-1;o>=0;o--)a[o]!=null&&document.head.appendChild(a[o].ref)}a[s]=null,t.set(n,a)}else r.ref.parentNode&&r.ref.parentNode.removeChild(r.ref)}}}}function Hi(){const t=[];return or(()=>dt(Ki(t))),{addTag(e){if(_t.indexOf(e.tag)!==-1){const r=e.tag==="title"?Ee:xe,s=se(e,r),i=t.findIndex(n=>n.tag===e.tag&&se(n,r)===s);i!==-1&&t.splice(i,1)}return t.push(e),t.length},removeTag(e,r){}}}const Bi=t=>{const e=$?Hi():Ui();return w(Dt.Provider,{value:e,get children(){return t.children}})},Mt=(t,e,r)=>(Wi({tag:t,props:e,setting:r,id:tr(),get name(){return e.name||e.property}}),null);function Wi(t){const e=nt(Dt);if(!e)throw new Error("<MetaProvider /> should be in the tree");at(()=>{const r=e.addTag(t);ke(()=>e.removeTag(t,r))})}function Ki(t){return t.map(e=>{const s=Object.keys(e.props).map(n=>n==="children"?"":` ${n}="${ve(e.props[n],!0)}"`).join(""),i=e.props.children;return e.setting?.close?`<${e.tag} data-sm="${e.id}"${s}>${e.setting?.escape?ve(i):i||""}</${e.tag}>`:`<${e.tag} data-sm="${e.id}"${s}/>`}).join("")}const Xi=t=>Mt("title",t,{escape:!0,close:!0}),me=t=>Mt("link",t);function qt(){let t=new Set;function e(i){return t.add(i),()=>t.delete(i)}let r=!1;function s(i,n){if(r)return!(r=!1);const a={to:i,options:n,defaultPrevented:!1,preventDefault:()=>a.defaultPrevented=!0};for(const o of t)o.listener({...a,from:o.location,retry:l=>{l&&(r=!0),o.navigate(i,{...n,resolve:!1})}});return!a.defaultPrevented}return{subscribe:e,confirm:s}}let Pe;function je(){(!window.history.state||window.history.state._depth==null)&&window.history.replaceState({...window.history.state,_depth:window.history.length-1},""),Pe=window.history.state._depth}$||je();function Ji(t){return{...t,_depth:window.history.state&&window.history.state._depth}}function Gi(t,e){let r=!1;return()=>{const s=Pe;je();const i=s==null?null:Pe-s;if(r){r=!1;return}i&&e(i)?(r=!0,window.history.go(-i)):t()}}const Zi=/^(?:[a-z0-9]+:)?\/\//i,Qi=/^\/+|(\/)\/+$/g,Ut="http://sr";function H(t,e=!1){const r=t.replace(Qi,"$1");return r?e||/^[?#]/.test(r)?r:"/"+r:""}function ee(t,e,r){if(Zi.test(e))return;const s=H(t),i=r&&H(r);let n="";return!i||e.startsWith("/")?n=s:i.toLowerCase().indexOf(s.toLowerCase())!==0?n=s+i:n=i,(n||"/")+H(e,!n)}function Yi(t,e){return H(t).replace(/\/*(\*.*)?$/g,"")+H(e)}function Le(t){const e={};return t.searchParams.forEach((r,s)=>{e[s]=r}),e}function en(t,e,r){const[s,i]=t.split("/*",2),n=s.split("/").filter(Boolean),a=n.length;return o=>{const l=o.split("/").filter(Boolean),c=l.length-a;if(c<0||c>0&&i===void 0&&!e)return null;const d={path:a?"":"/",params:{}},u=m=>r===void 0?void 0:r[m];for(let m=0;m<a;m++){const y=n[m],h=l[m],f=y[0]===":",g=f?y.slice(1):y;if(f&&ge(h,u(g)))d.params[g]=h;else if(f||!ge(h,y))return null;d.path+=`/${h}`}if(i){const m=c?l.slice(-c).join("/"):"";if(ge(m,u(i)))d.params[i]=m;else return null}return d}}function ge(t,e){const r=s=>s.localeCompare(t,void 0,{sensitivity:"base"})===0;return e===void 0?!0:typeof e=="string"?r(e):typeof e=="function"?e(t):Array.isArray(e)?e.some(r):e instanceof RegExp?e.test(t):!1}function tn(t){const[e,r]=t.pattern.split("/*",2),s=e.split("/").filter(Boolean);return s.reduce((i,n)=>i+(n.startsWith(":")?2:3),s.length-(r===void 0?0:1))}function Ht(t){const e=new Map,r=ot();return new Proxy({},{get(s,i){return e.has(i)||lt(r,()=>e.set(i,x(()=>t()[i]))),e.get(i)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(t())}})}function Bt(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let r=t.slice(0,e.index),s=t.slice(e.index+e[0].length);const i=[r,r+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(s);)i.push(r+=e[1]),s=s.slice(e[0].length);return Bt(s).reduce((n,a)=>[...n,...i.map(o=>o+a)],[])}const rn=100,sn=Ie(),Ne=Ie();function nn(t,e=""){const{component:r,load:s,children:i,info:n}=t,a=!i||Array.isArray(i)&&!i.length,o={key:t,component:r,load:s,info:n};return Wt(t.path).reduce((l,c)=>{for(const d of Bt(c)){const u=Yi(e,d);let m=a?u:u.split("/*",1)[0];m=m.split("/").map(y=>y.startsWith(":")||y.startsWith("*")?y:encodeURIComponent(y)).join("/"),l.push({...o,originalPath:d,pattern:m,matcher:en(m,!a,t.matchFilters)})}return l},[])}function an(t,e=0){return{routes:t,score:tn(t[t.length-1])*1e4-e,matcher(r){const s=[];for(let i=t.length-1;i>=0;i--){const n=t[i],a=n.matcher(r);if(!a)return null;s.unshift({...a,route:n})}return s}}}function Wt(t){return Array.isArray(t)?t:[t]}function Kt(t,e="",r=[],s=[]){const i=Wt(t);for(let n=0,a=i.length;n<a;n++){const o=i[n];if(o&&typeof o=="object"){o.hasOwnProperty("path")||(o.path="");const l=nn(o,e);for(const c of l){r.push(c);const d=Array.isArray(o.children)&&o.children.length===0;if(o.children&&!d)Kt(o.children,c.pattern,r,s);else{const u=an([...r],s.length);s.push(u)}r.pop()}}}return r.length?s:s.sort((n,a)=>a.score-n.score)}function ie(t,e){for(let r=0,s=t.length;r<s;r++){const i=t[r].matcher(e);if(i)return i}return[]}function on(t,e){const r=new URL(Ut),s=x(l=>{const c=t();try{return new URL(c,r)}catch{return console.error(`Invalid path ${c}`),l}},r,{equals:(l,c)=>l.href===c.href}),i=x(()=>s().pathname),n=x(()=>s().search,!0),a=x(()=>s().hash),o=()=>"";return{get pathname(){return i()},get search(){return n()},get hash(){return a()},get state(){return e()},get key(){return o()},query:Ht(ct(n,()=>Le(s())))}}let I;function ln(t,e,r,s={}){const{signal:[i,n],utils:a={}}=t,o=a.parsePath||(p=>p),l=a.renderPath||(p=>p),c=a.beforeLeave||qt(),d=ee("",s.base||"");if(d===void 0)throw new Error(`${d} is not a valid base path`);d&&!i().value&&n({value:d,replace:!0,scroll:!1});const[u,m]=D(!1),y=async p=>{m(!0);try{await rr(p)}finally{m(!1)}},[h,f]=D(i().value),[g,v]=D(i().state),X=on(h,g),z=[],P=D($?Yt():[]),N={pattern:d,params:{},path:()=>d,outlet:()=>null,resolvePath(p){return ee(d,p)}};return at(()=>{const{value:p,state:b}=i();De(()=>{p!==h()&&y(()=>{I="native",f(p),v(b),_e(),P[1]([])}).then(()=>{I=void 0})})}),{base:N,location:X,isRouting:u,renderPath:l,parsePath:o,navigatorFactory:Gt,beforeLeave:c,preloadRoute:Qt,singleFlight:s.singleFlight===void 0?!0:s.singleFlight,submissions:P};function Jt(p,b,F){De(()=>{if(typeof b=="number"){b&&(a.go?a.go(b):console.warn("Router integration does not support relative routing"));return}const{replace:J,resolve:oe,scroll:C,state:T}={replace:!1,resolve:!0,scroll:!0,...F},A=oe?p.resolvePath(b):ee("",b);if(A===void 0)throw new Error(`Path '${b}' is not a routable path`);if(z.length>=rn)throw new Error("Too many redirects");const Ve=h();if(A!==Ve||T!==g()){if($){const G=B();G&&(G.response={status:302,headers:new Headers({Location:A})}),n({value:A,replace:J,scroll:C,state:T})}else if(c.confirm(A,F)){const G=z.push({value:Ve,replace:J,scroll:C,state:g()});y(()=>{I="navigate",f(A),v(T),_e(),P[1]([])}).then(()=>{z.length===G&&(I=void 0,Zt({value:A,state:T}))})}}})}function Gt(p){return p=p||nt(Ne)||N,(b,F)=>Jt(p,b,F)}function Zt(p){const b=z[0];b&&((p.value!==b.value||p.state!==b.state)&&n({...p,replace:b.replace,scroll:b.scroll}),z.length=0)}function Qt(p,b){const F=ie(r(),p.pathname),J=I;I="preload";for(let oe in F){const{route:C,params:T}=F[oe];C.component&&C.component.preload&&C.component.preload();const{load:A}=C;b&&A&&lt(e(),()=>A({params:T,location:{pathname:p.pathname,search:p.search,hash:p.hash,query:Le(p),state:null,key:""},intent:"preload"}))}I=J}function Yt(){const p=B();return p&&p.router&&p.router.submission?[p.router.submission]:[]}}function cn(t,e,r,s,i){const{base:n,location:a}=t,{pattern:o,component:l,load:c}=s().route,d=x(()=>s().path);l&&l.preload&&l.preload();const u=c?c({params:i,location:a,intent:I||"initial"}):void 0;return{parent:e,pattern:o,path:d,params:i,outlet:()=>l?it(l,{params:i,location:a,data:u,get children(){return r()}}):r(),resolvePath(y){return ee(n.path(),y,d())}}}const Xt=t=>e=>{const{base:r}=e,s=sr(()=>e.children),i=x(()=>Kt(e.root?{component:e.root,load:e.rootLoad,children:s()}:s(),e.base||""));let n;const a=ln(t,()=>n,i,{base:r,singleFlight:e.singleFlight});return t.create&&t.create(a),w(sn.Provider,{value:a,get children(){return[(n=ot())&&null,w(un,{routerState:a,get branches(){return i()}})]}})};function un(t){const e=x(()=>ie(t.branches,t.routerState.location.pathname));if($){const a=B();if(a&&a.router&&a.router.dataOnly){hn(a,t.branches);return}a&&((a.router||(a.router={})).matches||(a.router.matches=e().map(({route:o,path:l,params:c})=>({path:o.originalPath,pattern:o.pattern,match:l,params:c,info:o.info}))))}const r=Ht(()=>{const a=e(),o={};for(let l=0;l<a.length;l++)Object.assign(o,a[l].params);return o}),s=[];let i;const n=x(ct(e,(a,o,l)=>{let c=o&&a.length===o.length;const d=[];for(let u=0,m=a.length;u<m;u++){const y=o&&o[u],h=a[u];l&&y&&h.route.key===y.route.key?d[u]=l[u]:(c=!1,s[u]&&s[u](),ir(f=>{s[u]=f,d[u]=cn(t.routerState,d[u-1]||t.routerState.base,dn(()=>n()[u+1]),()=>e()[u],r)}))}return s.splice(a.length).forEach(u=>u()),l&&c?l:(i=d[0],d)}));return w(ut,{get when(){return n()&&i},keyed:!0,children:a=>w(Ne.Provider,{value:a,get children(){return a.outlet()}})})}const dn=t=>()=>w(ut,{get when(){return t()},keyed:!0,children:e=>w(Ne.Provider,{value:e,get children(){return e.outlet()}})});function hn(t,e){const r=new URL(t.request.url),s=ie(e,new URL(t.router.previousUrl||t.request.url).pathname),i=ie(e,r.pathname);for(let n=0;n<i.length;n++){(!s[n]||i[n].route!==s[n].route)&&(t.router.dataOnly=!0);const{route:a,params:o}=i[n];a.load&&a.load({params:o,location:{pathname:r.pathname,search:r.search,hash:r.hash,query:Le(r),state:null,key:""},intent:"preload"})}}function fn([t,e],r,s){return[r?()=>r(t()):t,s?i=>e(s(i)):e]}function pn(t){if(t==="#")return null;try{return document.querySelector(t)}catch{return null}}function mn(t){let e=!1;const r=i=>typeof i=="string"?{value:i}:i,s=fn(D(r(t.get()),{equals:(i,n)=>i.value===n.value}),void 0,i=>(!e&&t.set(i),i));return t.init&&ke(t.init((i=t.get())=>{e=!0,s[1](r(i)),e=!1})),Xt({signal:s,create:t.create,utils:t.utils})}function gn(t,e,r){return t.addEventListener(e,r),()=>t.removeEventListener(e,r)}function vn(t,e){const r=pn(`#${t}`);r?r.scrollIntoView():e&&window.scrollTo(0,0)}function yn(t){const e=new URL(t);return e.pathname+e.search}function bn(t){let e;const r={value:t.url||(e=B())&&yn(e.request.url)||""};return Xt({signal:[()=>r,s=>Object.assign(r,s)]})(t)}const wn=new Map;function Sn(t=!0,e=!1,r="/_server"){return s=>{const i=s.base.path(),n=s.navigatorFactory(s.base);let a={};function o(h){return h.namespaceURI==="http://www.w3.org/2000/svg"}function l(h){if(h.defaultPrevented||h.button!==0||h.metaKey||h.altKey||h.ctrlKey||h.shiftKey)return;const f=h.composedPath().find(N=>N instanceof Node&&N.nodeName.toUpperCase()==="A");if(!f||e&&!f.hasAttribute("link"))return;const g=o(f),v=g?f.href.baseVal:f.href;if((g?f.target.baseVal:f.target)||!v&&!f.hasAttribute("state"))return;const z=(f.getAttribute("rel")||"").split(/\s+/);if(f.hasAttribute("download")||z&&z.includes("external"))return;const P=g?new URL(v,document.baseURI):new URL(v);if(!(P.origin!==window.location.origin||i&&P.pathname&&!P.pathname.toLowerCase().startsWith(i.toLowerCase())))return[f,P]}function c(h){const f=l(h);if(!f)return;const[g,v]=f,X=s.parsePath(v.pathname+v.search+v.hash),z=g.getAttribute("state");h.preventDefault(),n(X,{resolve:!1,replace:g.hasAttribute("replace"),scroll:!g.hasAttribute("noscroll"),state:z&&JSON.parse(z)})}function d(h){const f=l(h);if(!f)return;const[g,v]=f;a[v.pathname]||s.preloadRoute(v,g.getAttribute("preload")!=="false")}function u(h){const f=l(h);if(!f)return;const[g,v]=f;a[v.pathname]||(a[v.pathname]=setTimeout(()=>{s.preloadRoute(v,g.getAttribute("preload")!=="false"),delete a[v.pathname]},200))}function m(h){const f=l(h);if(!f)return;const[,g]=f;a[g.pathname]&&(clearTimeout(a[g.pathname]),delete a[g.pathname])}function y(h){let f=h.submitter&&h.submitter.hasAttribute("formaction")?h.submitter.getAttribute("formaction"):h.target.getAttribute("action");if(!f)return;if(!f.startsWith("https://action/")){const v=new URL(f,Ut);if(f=s.parsePath(v.pathname+v.search),!f.startsWith(r))return}if(h.target.method.toUpperCase()!=="POST")throw new Error("Only POST forms are supported for Actions");const g=wn.get(f);if(g){h.preventDefault();const v=new FormData(h.target);h.submitter&&h.submitter.name&&v.append(h.submitter.name,h.submitter.value),g.call(s,v)}}lr(["click","submit"]),document.addEventListener("click",c),t&&(document.addEventListener("mouseover",u),document.addEventListener("mouseout",m),document.addEventListener("focusin",d),document.addEventListener("touchstart",d)),document.addEventListener("submit",y),ke(()=>{document.removeEventListener("click",c),t&&(document.removeEventListener("mouseover",u),document.removeEventListener("mouseout",m),document.removeEventListener("focusin",d),document.removeEventListener("touchstart",d)),document.removeEventListener("submit",y)})}}function zn(t){if($)return bn(t);const e=()=>({value:window.location.pathname+window.location.search+window.location.hash,state:window.history.state}),r=qt();return mn({get:e,set({value:s,replace:i,scroll:n,state:a}){i?window.history.replaceState(Ji(a),"",s):window.history.pushState(a,"",s),vn(window.location.hash.slice(1),n),je()},init:s=>gn(window,"popstate",Gi(s,i=>{if(i&&i<0)return!r.confirm(i);{const n=e();return!r.confirm(n.value,{state:n.state})}})),create:Sn(t.preload,t.explicitLinks,t.actionBase),utils:{go:s=>window.history.go(s),beforeLeave:r}})(t)}function Rn(){return w(zn,{root:t=>w(Bi,{get children(){return[w(Xi,{children:"Trfico"}),w(me,{rel:"preconnect",href:"https://fonts.googleapis.com"}),w(me,{rel:"preconnect",href:"https://fonts.gstatic.com"}),w(me,{href:"https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap",rel:"stylesheet"}),w(nr,{get children(){return t.children}})]}}),get children(){return w(_i,{})}})}function An(t){const r=t.length.toString(16),s="00000000".substring(0,8-r.length)+r;return new TextEncoder().encode(`;0x${s};${t}`)}function En(t,e){return new ReadableStream({start(r){Ms(e,{scopeId:t,plugins:[xt,Pt,It,kt,ne,ae,Ft,Ct,Ot,$t],onSerialize(s,i){r.enqueue(An(i?`(${kr(t)},${s})`:s))},onDone(){r.close()},onError(s){r.error(s)}})}})}async function xn(t){const e=Ei(t),r=e.request,s=r.headers.get("X-Server-Id"),i=r.headers.get("X-Server-Instance"),n=r.headers.has("X-Single-Flight"),a=new URL(r.url);let o,l;if(s)zi(typeof s=="string","Invalid server function"),[o,l]=s.split("#");else if(o=a.searchParams.get("id"),l=a.searchParams.get("name"),!o||!l)throw new Error("Invalid request");const c=(await globalThis.MANIFEST["server-fns"].chunks[o].import())[l];let d=[];if(!i||t.method==="GET"){const u=a.searchParams.get("args");u&&JSON.parse(u).forEach(m=>d.push(m))}if(t.method==="POST"){const u=r.headers.get("content-type");if(u?.startsWith("multipart/form-data")||u?.startsWith("application/x-www-form-urlencoded"))d.push(await new Request(r,{...r,body:t.node.req.body}).formData());else if(u?.startsWith("application/json")){const m=new Request(r,{...r,body:t.node.req.body});d=Ns(await m.json(),{plugins:[xt,Pt,It,kt,ne,ae,Ft,Ct,Ot,$t]})}}try{let u=await ht(e,async()=>(Fe.context={event:e},c(...d)));if(n&&i&&(u=await Pn(e,u)),u instanceof Response&&i&&(u.headers&&tt(t,u.headers),u.customBody?u=await u.customBody():u.body==null&&(u=null)),!i){const m=u instanceof Error,y=new URL(r.headers.get("referer"));return new Response(null,{status:302,headers:{Location:y.toString(),...u?{"Set-Cookie":`flash=${JSON.stringify({url:a.pathname+encodeURIComponent(a.search),result:m?u.message:u,error:m,input:[...d.slice(0,-1),[...d[d.length-1].entries()]]})}; Secure; HttpOnly;`}:{}}})}return jt(t,"content-type","text/javascript"),En(i,u)}catch(u){return u instanceof Response&&(u.status===302&&!i&&Ae(t,302),u.headers&&tt(t,u.headers),u.customBody?u=u.customBody():u.body==null&&(u=null)),u}}async function Pn(t,e){let r,s=new URL(t.request.headers.get("referer")).toString();e instanceof Response&&(e.headers.has("X-Revalidate")&&(r=e.headers.get("X-Revalidate").split(",")),e.headers.has("Location")&&(s=new URL(e.headers.get("Location"),new URL(t.request.url).origin+"").toString()));const i=Ai(t);return i.request=new Request(s),await ht(i,async()=>{await qi(i),i.router.dataOnly=r||!0,i.router.previousUrl=t.request.headers.get("referer");try{cr(()=>{Fe.context.event=i,Rn()})}catch(o){console.log(o)}const n=i.router.data;if(!n)return e;let a=!1;for(const o in n)n[o]===void 0?delete n[o]:a=!0;return a&&(e instanceof Response?e.customBody&&(n._$value=e.customBody()):(n._$value=e,e=new Response(null,{status:200})),e.customBody=()=>n,e.headers.set("X-Single-Flight","true")),e})}const Bn=Ar(xn);export{Xi as T,Bn as h};
